<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="Vegeta&#39;s Blog">
    

    <!--Author-->
    
        <meta name="author" content="Stubborn Vegeta">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Stubborn Vegeta"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="Vegeta&#39;s Blog" />
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Stubborn Vegeta"/>

    <!--Type page-->
    
        <meta property="og:type" content="website" />
    

    <!--Page Cover-->
    

    
        <meta name="twitter:card" content="summary" />
    
    
    

    <!-- Title -->
    
    <title>Stubborn Vegeta</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Google Analytics -->
    


<meta name="generator" content="Hexo 4.2.0"></head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    Home
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    Archives
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/about">
                    About
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/tags">
                    Tags
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/categories">
                    Categories
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/contact">
                    Contact
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
            <h1 id="main-title" class="title">Stubborn Vegeta</h1>
        
    </div>
</header>

        <section class="main">
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/07/03/PlotNeuralNet%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/">
                PlotNeuralNet个性化定制与使用说明
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-07-03</span>
            
            
            
                <span class="category">
                    <a href="/categories/PlotNeuralNet/">PlotNeuralNet</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h2 id="如何定制你的PlotNeuralNet"><a href="#如何定制你的PlotNeuralNet" class="headerlink" title="如何定制你的PlotNeuralNet"></a>如何定制你的PlotNeuralNet</h2><p>PlotNeuralNet最新版默认将图形的深度标注在角上，我们一般希望它居中标注。所以我们需要对它进行修改。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  +-----+       +-----+</span><br><span class="line"> &#x2F;     &#x2F;|      &#x2F;     &#x2F;|</span><br><span class="line">+-----+ |     +-----+ |</span><br><span class="line">|     | +     |     | +</span><br><span class="line">|     |&#x2F;      |     |&#x2F; a</span><br><span class="line">+-----+ a     +-----+</span><br><span class="line">默认效果       期望效果</span><br></pre></td></tr></table></figure>
<p>只需要修改layers文件夹下的<code>Box.sty</code>和<code>RightBandedBox.sty</code>文件即可。</p>
<h3 id="Box-sty"><a href="#Box-sty" class="headerlink" title="Box.sty"></a>Box.sty</h3><p>将depthlabel设置中的<code>pos=0</code>改为<code>pos=0.5</code>，后面将captionlabel中的文本宽度修改掉是因为默认宽度有些小，长文本显示不全。</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">diff --git a/B.sty b/Box.sty</span><br><span class="line">index 38818a8..854edbb 100644</span><br><span class="line"><span class="comment">--- a/B.sty</span></span><br><span class="line"><span class="comment">+++ b/Box.sty</span></span><br><span class="line"><span class="meta">@@ -42,13 +42,13 @@</span></span><br><span class="line"></span><br><span class="line">         \coordinate (a1) at (0 , \y/2 , \z/2);</span><br><span class="line">         \coordinate (b1) at (0 ,-\y/2 , \z/2);</span><br><span class="line"><span class="deletion">-        \tikzstyle&#123;depthlabel&#125;=[pos=0,text width=14*\z,text centered,sloped]</span></span><br><span class="line"><span class="addition">+        \tikzstyle&#123;depthlabel&#125;=[pos=0.5,text width=14*\z,text centered,sloped]</span></span><br><span class="line"></span><br><span class="line">         \path (c) edge ["\small\zlabel"',depthlabel](f); %depth label</span><br><span class="line">         \path (b1) edge ["\ylabel",midway] (a1);  %height label</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="deletion">-        \tikzstyle&#123;captionlabel&#125;=[text width=15*\LastEastx/\scale,text centered]</span></span><br><span class="line"><span class="addition">+        \tikzstyle&#123;captionlabel&#125;=[text width=40*\LastEastx/\scale,text centered]</span></span><br><span class="line">         \path (\LastEastx/2,-\y/2,+\z/2) + (0,-25pt) coordinate (cap)</span><br><span class="line">         edge ["\textcolor&#123;black&#125;&#123; \bf \caption&#125;"',captionlabel](cap) ; %Block caption/pic object label</span><br></pre></td></tr></table></figure>
<p><code>Box.sty</code>是修改后的版本。</p>
<h3 id="RightBandedBox-sty"><a href="#RightBandedBox-sty" class="headerlink" title="RightBandedBox.sty"></a>RightBandedBox.sty</h3><p><code>RightBandedBox.sty</code>的修改与<code>Box.sty</code>的修改类似。</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">diff --git a/R.sty b/RightBandedBox.sty</span><br><span class="line">index 7d74a51..adad188 100644</span><br><span class="line"><span class="comment">--- a/R.sty</span></span><br><span class="line"><span class="comment">+++ b/RightBandedBox.sty</span></span><br><span class="line"><span class="meta">@@ -60,12 +60,12 @@</span></span><br><span class="line"></span><br><span class="line">         \coordinate (a1) at (0 , \y/2 , \z/2);</span><br><span class="line">         \coordinate (b1) at (0 ,-\y/2 , \z/2);</span><br><span class="line"><span class="deletion">-        \tikzstyle&#123;depthlabel&#125;=[pos=0,text width=14*\z,text centered,sloped]</span></span><br><span class="line"><span class="addition">+        \tikzstyle&#123;depthlabel&#125;=[pos=0.5,text width=14*\z,text centered,sloped]</span></span><br><span class="line"></span><br><span class="line">         \path (c) edge ["\small\zlabels"',depthlabel](f); %depth label</span><br><span class="line">         \path (b1) edge ["\ylabel",midway] (a1);  %height label</span><br><span class="line"></span><br><span class="line"><span class="deletion">-        \tikzstyle&#123;captionlabel&#125;=[text width=15*\LastEastx/\scale,text centered]</span></span><br><span class="line"><span class="addition">+        \tikzstyle&#123;captionlabel&#125;=[text width=40*\LastEastx/\scale,text centered]</span></span><br><span class="line">         \path (\LastEastx/2,-\y/2,+\z/2) + (0,-25pt) coordinate (cap)</span><br><span class="line">         edge ["\textcolor&#123;black&#125;&#123; \bf \caption&#125;"',captionlabel] (cap); %Block caption/pic object label</span><br></pre></td></tr></table></figure>
<p><code>RightBandedBox.sty</code>是修改后的版本。</p>
<h3 id="添加自定义的形状"><a href="#添加自定义的形状" class="headerlink" title="添加自定义的形状"></a>添加自定义的形状</h3><p>修改pycore文件夹下的tikzeng.py文件。</p>
<p>我主要进行了以下改动：</p>
<ul>
<li><p>修改了<code>SoftmaxColor</code>(softmax的颜色)</p>
</li>
<li><p>添加了<code>to_Linear</code>函数(linear)</p>
<ul>
<li>只有一个标注参数</li>
</ul>
</li>
<li><p>添加了<code>to_LinearRelu</code>函数(linear后接Relu激活函数)</p>
</li>
<li><p>修改了<code>to_Conv</code> 函数(卷积层)</p>
<ul>
<li>输入的标注参数从”s_fiter, n_filter”变为了”x, y, n_filter”(<code>to_ConvRelu</code>函数也是这三个标注参数)<ul>
<li>x: 深度 (特征图的长)</li>
<li>y: 高度 (特征图的宽)</li>
<li>n_filter: 宽度 (卷积核的数量)</li>
</ul>
</li>
</ul>
</li>
<li><p>添加了<code>to_ConvRelu</code>函数(一层卷积后接Relu函数)</p>
</li>
<li><p>添加了<code>to_dashed_connection</code>函数(连接图形的四个角)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">  +-----+-------+-----+</span><br><span class="line"> &#x2F;     &#x2F;|      &#x2F;|    &#x2F;|</span><br><span class="line">+-----+-|-----+-|---+ |</span><br><span class="line">|     | +-----|-+   | +</span><br><span class="line">|     |&#x2F;      |&#x2F;    |&#x2F;</span><br><span class="line">+-----+-------+-----+</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>更多细节在<a href="./pycore/tikzeng.py">tikzeng.py</a></p>
<p>具体的规则如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(parameter)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">r"""</span></span><br><span class="line"><span class="string">    LaTeX grammar</span></span><br><span class="line"><span class="string">    """</span></span><br></pre></td></tr></table></figure>
<p>因此你需要掌握基本的LaTeX语法才能对其进行修改，不过这个比较简单，就算你不会，照着样子也可以写出来。比如<code>to_ConvRelu</code>函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Conv,relu</span></span><br><span class="line"><span class="comment"># Bottleneck</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_ConvRelu</span><span class="params">( name, x=<span class="number">256</span>, y=<span class="number">256</span>, n_filer=<span class="number">64</span>, offset=<span class="string">"(0,0,0)"</span>, to=<span class="string">"(0,0,0)"</span>, width=<span class="number">2</span>, height=<span class="number">40</span>, depth=<span class="number">40</span>, caption=<span class="string">" "</span> )</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">r"""</span></span><br><span class="line"><span class="string">\pic[shift=&#123; """</span>+ offset +<span class="string">""" &#125;] at """</span>+ to +<span class="string">""" </span></span><br><span class="line"><span class="string">    &#123;RightBandedBox=&#123;</span></span><br><span class="line"><span class="string">        name="""</span>+ name +<span class="string">""",</span></span><br><span class="line"><span class="string">        caption="""</span>+ caption +<span class="string">""",</span></span><br><span class="line"><span class="string">        xlabel=&#123;&#123;"""</span>+ str(n_filer) +<span class="string">""", &#125;&#125;,</span></span><br><span class="line"><span class="string">        ylabel= """</span>+ str(y) +<span class="string">""",</span></span><br><span class="line"><span class="string">        zlabel="""</span>+ str(x) +<span class="string">""",</span></span><br><span class="line"><span class="string">        fill=\ConvColor,</span></span><br><span class="line"><span class="string">        bandfill=\ConvReluColor,</span></span><br><span class="line"><span class="string">        height="""</span>+ str(height) +<span class="string">""",</span></span><br><span class="line"><span class="string">        width= """</span>+ str(width) +<span class="string">""",</span></span><br><span class="line"><span class="string">        depth="""</span>+ str(depth) +<span class="string">"""</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;;</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>offset</code>是当前图形距离上一图形的距离。</p>
</li>
<li><p><code>to</code>是上一图形的位置。</p>
</li>
<li><p><code>to_ConvRelu</code>是一层卷积后接一个Relu激活函数，可以理解成两层，所以要调用<code>RightBandedBox</code>，<code>Box</code>是只有一层的情况下使用。</p>
</li>
<li><p><code>name</code>是你这个图形的名字，在LaTeX中，我们认为它是一个节点，<code>name</code>的内容不会显示到图片上，只是为了让你更方便的找到这个图形。</p>
</li>
<li><p><code>caption</code>是图形标题，会显示在图形正下方。</p>
</li>
<li><p><code>xlabel</code>，<code>ylabel</code>，<code>zlabel</code>跟命名一样，它们就是标签，我叫它标注参数。</p>
</li>
<li><p><code>fill</code>设置你图形第一层的颜色。</p>
</li>
<li><p><code>bandfill</code>设置你图形第二层的颜色</p>
</li>
<li><p><code>height</code>，<code>width</code>，<code>depth</code>设置你图形的尺寸。</p>
</li>
</ul>
<h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>你需要安装LaTeX，Linux安装<code>TeXlive</code>或者根据官方说明<code>https://github.com/HarisIqbal88/PlotNeuralNet</code>安装，Windows下也可以安装<code>TeXlive</code>，如果你只是想画图，不想使用LaTeX，你可以安装<code>MikTeX</code>，如果是Windows系统还需要安装<code>git bash</code>(不安装也可以)</p>
<h3 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h3><p>下载gtihub仓库：<br>    - 我修改过的仓库：<a href="https://github.com/demonlord1997/PlotNeuralNet">https://github.com/demonlord1997/PlotNeuralNet</a><br>    - 原本仓库：<a href="https://github.com/HarisIqbal88/PlotNeuralNet">https://github.com/HarisIqbal88/PlotNeuralNet</a></p>
<ol>
<li><p>在PlotNeuralNet文件夹中新建一个<code>my_project</code>文件夹</p>
</li>
<li><p>进入<code>my_project</code>新建一个python文件<code>my_arch</code></p>
</li>
<li><p>写入以下内容：</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.path.append(<span class="string">'../'</span>)</span><br><span class="line"><span class="keyword">from</span> pycore.tikzeng <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># defined your arch</span></span><br><span class="line">arch = [</span><br><span class="line">    to_head( <span class="string">'..'</span> ),</span><br><span class="line">    to_cor(),</span><br><span class="line">    to_begin(),</span><br><span class="line">    to_Conv(<span class="string">"input"</span>, <span class="number">32</span>, <span class="number">40</span>, <span class="string">""</span>, offset=<span class="string">"(0,0,0)"</span>, to=<span class="string">"(0,0,0)"</span>, width=<span class="number">1</span>, height=<span class="number">40</span>, depth=<span class="number">32</span>, caption=<span class="string">"Input"</span>),</span><br><span class="line">    to_ConvRelu(<span class="string">"conv1"</span>, <span class="number">32</span>, <span class="number">12</span>, <span class="number">32</span>, offset=<span class="string">"(3,0,0)"</span>, to=<span class="string">"(input-east)"</span>, width=<span class="number">5</span>, height=<span class="number">32</span>, depth=<span class="number">32</span>, caption=<span class="string">"Conv1"</span> ),</span><br><span class="line">    to_ConvRelu(<span class="string">"conv2"</span>, <span class="number">32</span>, <span class="number">4</span>, <span class="number">32</span>, offset=<span class="string">"(3,0,0)"</span>, to=<span class="string">"(conv1-east)"</span>, width=<span class="number">5</span>, height=<span class="number">12</span>, depth=<span class="number">32</span> ,caption=<span class="string">"Conv2"</span>),</span><br><span class="line"></span><br><span class="line">    to_LinearRelu(<span class="string">"linear1"</span>, <span class="number">4096</span> ,<span class="string">"(2,0,0)"</span>, <span class="string">"(conv2-east)"</span>, caption=<span class="string">"Flattening"</span>  ),</span><br><span class="line"></span><br><span class="line">    to_LinearRelu(<span class="string">"linear2"</span>, <span class="number">512</span>, <span class="string">"(2,0,0)"</span>, <span class="string">"(linear1-east)"</span>, width=<span class="number">1.5</span>, height=<span class="number">3</span>, depth=<span class="number">16</span>, caption=<span class="string">"Linear"</span>),</span><br><span class="line">    to_SoftMax(<span class="string">"soft"</span>, <span class="number">4</span> ,<span class="string">"(2,0,0)"</span>, <span class="string">"(linear2-east)"</span>, caption=<span class="string">"LogSoftMax"</span>, depth=<span class="number">4</span>  ),</span><br><span class="line">    to_dashed_connection( <span class="string">"input"</span>, <span class="string">"conv1"</span>),</span><br><span class="line">    <span class="comment"># to_dashed_connection( "conv1", "conv2"),</span></span><br><span class="line">    <span class="comment"># to_dashed_connection("conv2", "linear1"),</span></span><br><span class="line">    to_connection( <span class="string">"input"</span>, <span class="string">"conv1"</span>),</span><br><span class="line">    to_connection( <span class="string">"conv1"</span>, <span class="string">"conv2"</span>),</span><br><span class="line">    to_connection(<span class="string">"conv2"</span>, <span class="string">"linear1"</span>),</span><br><span class="line">    to_connection(<span class="string">"linear1"</span>, <span class="string">"linear2"</span>),</span><br><span class="line">    to_connection( <span class="string">"linear2"</span>,<span class="string">"soft"</span>),</span><br><span class="line">    to_end()</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    namefile = str(sys.argv[<span class="number">0</span>]).split(<span class="string">'.'</span>)[<span class="number">0</span>]</span><br><span class="line">    to_generate(arch, namefile + <span class="string">'.tex'</span> )</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>执行<code>tikzmake.sh</code>脚本(windows下需安装<code>git bash</code>)<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash ../tikzmake.sh my_arch</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>windows如果不安装<code>git bash</code>，可以先运行<code>my_arch.py</code>生成<code>my_arch.tex</code>，然后编译<code>my_arch.tex</code>即可。</p>
<center>
<img src="https://s1.ax1x.com/2020/07/03/NOcoEn.png" alt="my example" height="85%" width="85%" />
</center>

<p>为了支持中文，我将<code>tikzmake.sh</code>中的pdflatex改成了xelatex，如果你的系统中没有xelatex这个命令，而你又已经装了TeXlive或者MikTeX，可以手动指定xelatex的路径，像我这样：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/<span class="built_in">local</span>/texlive/2019/bin/x86_64-linux/xelatex <span class="variable">$1</span>.tex</span><br></pre></td></tr></table></figure>

<p>最后再次附上原仓库地址：<code>https://github.com/HarisIqbal88/PlotNeuralNet</code>，你可以自己修改添加一些函数。</p>
<p>如果你不想修改也可以直接下载我的仓库：<code>https://github.com/demonlord1997/PlotNeuralNet</code>，欢迎star。</p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/06/26/extract-images-from-pdf/">
                extract images from pdf
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-06-26</span>
            
            
            
                <span class="category">
                    <a href="/categories/配置/">配置</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <p>不想在做PPT的时候还要从论文中一个一个把图截下来，或者挨个图片保存，这种重复性的工作肯定有更好的解决办法。所以我找到了<code>pdfimages</code></p>
<p>用法很简单：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pdfimages -png &lt;PDF-file&gt; &lt;image-root&gt;</span><br><span class="line">e.g.</span><br><span class="line"></span><br><span class="line">pdfimages -png your.pdf images/out</span><br></pre></td></tr></table></figure>
<p>如果不加<code>-png</code>输出的ppm格式的图片，可能无法插入到PPT中。</p>
<p>到这里可以结束了，如果想更懒可以新建一个python文件(<code>efig.py</code>)：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># efig.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> call</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">"images"</span>):</span><br><span class="line">    os.makedirs(<span class="string">"images"</span>)</span><br><span class="line"></span><br><span class="line">parser = argparse.ArgumentParser(description=<span class="string">'extact_image_from_pdf'</span>)</span><br><span class="line">parser.add_argument(<span class="string">'--inputfile'</span>, <span class="string">'-i'</span>, help=<span class="string">'input your pdf file'</span>,required=<span class="literal">True</span>)</span><br><span class="line">args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">output = args.inputfile[<span class="number">0</span>:<span class="number">-4</span>]</span><br><span class="line">call([<span class="string">'pdfimages'</span>, <span class="string">'-png'</span>, args.inputfile, <span class="string">'images/'</span>+output])</span><br></pre></td></tr></table></figure>
<p>这个脚本会自动在你当前目录下创建images文件夹，并将图片名设置为pdf文件名+数字。</p>
<p>然后你可以修改你的<code>.bashrc</code>或者<code>.zshrc</code>来添加<code>efig</code>命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> efig=<span class="string">'python3 ~/scripts/efig.py'</span></span><br></pre></td></tr></table></figure>
<p>这里我将<code>efig.py</code>放在了<code>~/scripts</code>路径下，你可以根据需要改成你的路径。</p>
<p>添加好<code>efig</code>命令以后，你可以这样来完成图片的提取：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">efig -i &lt;PDF-file&gt;</span><br></pre></td></tr></table></figure>

<p>如果你使用<code>ranger</code>文件管理器，可以在<code>commands.py</code>添加<code>efig</code>类：</p>
<blockquote>
<p>commands.py文件一般在~/.config/ranger/下</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">efig</span><span class="params">(Command)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    :efig &lt;fname&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    extract all image from pdf.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Will create a folder named "images" in the current folder.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">execute</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">from</span> subprocess <span class="keyword">import</span> call</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">"images"</span>):</span><br><span class="line">            os.makedirs(<span class="string">"images"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.arg(<span class="number">1</span>):</span><br><span class="line">            input_file = self.fm.thisfile.path</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            input_file = self.rest(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        output = input_file[<span class="number">0</span>:<span class="number">-4</span>]</span><br><span class="line">        call([<span class="string">'pdfimages'</span>, <span class="string">'-png'</span>, input_file, <span class="string">'images/'</span>+output])</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tab</span><span class="params">(self, tabnum)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self._tab_directory_content()</span><br></pre></td></tr></table></figure>

<p>在<code>ranger</code>中输入<code>:efig &lt;PDF-file&gt;</code>即可，效果如图:</p>
<center>
<img src="https://s1.ax1x.com/2020/06/26/NrtLz4.gif" alt="ranger" height="80%" width="80%" />
</center>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/06/15/LaTeX-output-to-image/">
                LaTeX output to image
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-06-15</span>
            
            
            
                <span class="category">
                    <a href="/categories/LaTeX/">LaTeX</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <p>tikz画图输出是pdf格式，但是这种格式的图片，只有LaTeX可以插入到文章中，如果是word或者PPT都是无法插入这种图片的。</p>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p><strong>写一个pdf转图片的脚本</strong></p>
<h3 id="环境要求"><a href="#环境要求" class="headerlink" title="环境要求"></a>环境要求</h3><ul>
<li>pdf2image</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install pdf2image</span><br></pre></td></tr></table></figure>

<ul>
<li>pdfTools</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libpoppler-cpp-dev</span><br></pre></td></tr></table></figure>

<p>pdfTools的<a href="https://github.com/ropensci/pdftools#building-from-source">更多信息</a></p>
<h3 id="pdf2img-py"><a href="#pdf2img-py" class="headerlink" title="pdf2img.py"></a><code>pdf2img.py</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tempfile</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">from</span> pdf2image <span class="keyword">import</span> convert_from_path,convert_from_bytes</span><br><span class="line"></span><br><span class="line">parser = argparse.ArgumentParser(description=<span class="string">'pdf2image'</span>)</span><br><span class="line">parser.add_argument(<span class="string">'--inputfile'</span>, <span class="string">'-i'</span>, help=<span class="string">'input your pdf file'</span>,required=<span class="literal">True</span>)</span><br><span class="line">parser.add_argument(<span class="string">'--dpi'</span>, <span class="string">'-d'</span>, help=<span class="string">'input your image dpi'</span>,default=<span class="number">400</span>)</span><br><span class="line">parser.add_argument(<span class="string">'--outfolder'</span>, <span class="string">'-f'</span>, help=<span class="string">'set your image\'s path'</span>, required=<span class="literal">True</span>)</span><br><span class="line">parser.add_argument(<span class="string">'--outfile'</span>, <span class="string">'-o'</span>, help=<span class="string">'set your image\'s name'</span>, default=<span class="string">"out"</span>)</span><br><span class="line">args = parser.parse_args()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> tempfile.TemporaryDirectory() <span class="keyword">as</span> path:</span><br><span class="line">    image_from_path = convert_from_path(args.inputfile, dpi=args.dpi, fmt=<span class="string">'png'</span>,output_folder=args.outfolder,output_file=args.outfile)</span><br></pre></td></tr></table></figure>

<h4 id="pdf2img-py-使用示例"><a href="#pdf2img-py-使用示例" class="headerlink" title="pdf2img.py 使用示例"></a><code>pdf2img.py</code> 使用示例</h4><ul>
<li>参数说明</li>
</ul>
<p><code>--inputfile / -i</code>：你的pdf文件</p>
<p><code>--dpi / -d</code>：你需要的图片分辨率，默认是400</p>
<p><code>--outfolder / -f</code>：你图片的输出路径</p>
<p><code>--outfile / -o</code>：你的图片名</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 pdf2img.py -i example.pdf -d 400 -f . -o example</span><br></pre></td></tr></table></figure>

<h3 id="与vim交互"><a href="#与vim交互" class="headerlink" title="与vim交互"></a>与vim交互</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">autocmd</span> <span class="keyword">filetype</span> tex <span class="keyword">noremap</span> <span class="symbol">&lt;buffer&gt;</span> <span class="symbol">&lt;LEADER&gt;</span>i :!python3 ~/scripts/pdf2img.<span class="keyword">py</span> -i %&lt;.pdf -<span class="keyword">f</span> %:h -<span class="keyword">o</span> %&lt;<span class="symbol">&lt;CR&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里没有给dpi参数，直接按照默认的分辨率生成图片。</p>
<p>在你编译完tex文件生成pdf以后，按下<code>&lt;leader&gt;+i</code> 会自动调用<code>pdf2img.py</code>脚本将pdf转为png格式的图片，这里我将<code>pdf2img.py</code>放在了我scripts文件夹下，可以根据需要改成自己的路径。</p>
<h3 id="与ranger交互"><a href="#与ranger交互" class="headerlink" title="与ranger交互"></a>与ranger交互</h3><p>由于我的ranger是用python2编译的，但是我的脚本需要用python3运行，所以我重新用python3编译了我的ranger。</p>
<p>修改ranger的Makefile文件，将下列语句</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PYTHON ?= <span class="variable">$(<span class="built_in">shell</span> \</span></span><br><span class="line"><span class="variable">	     (python -c 'import sys; sys.exit(sys.version &lt; "2.6")</span>' &amp;&amp; \</span><br><span class="line">	      which python) \</span><br><span class="line">	     || (which python3) \</span><br><span class="line">	     || (python2 -c 'import sys; sys.exit(sys.version &lt; <span class="string">"2.6"</span>)' &amp;&amp; \</span><br><span class="line">	         which python2) \</span><br><span class="line">	   )</span><br></pre></td></tr></table></figure>
<p>修改为：</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">PYTHON ?= <span class="variable">$(<span class="built_in">shell</span> \</span></span><br><span class="line"><span class="variable">	     (which python3)</span> \</span><br><span class="line">	     || (python2 -c 'import sys; sys.exit(sys.version &lt; <span class="string">"2.6"</span>)' &amp;&amp; \</span><br><span class="line">	         which python2) \</span><br><span class="line">	   )</span><br></pre></td></tr></table></figure>
<p>执行<code>sudo make clean install</code></p>
<p>最后在ranger的配置目录中修改<code>commands.py</code>文件，添加<code>pdf2img</code>类：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">pdf2img</span><span class="params">(Command)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    :pdf2img &lt;fname&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Convert PDF-file to image</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">execute</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">import</span> tempfile</span><br><span class="line">        <span class="keyword">from</span> pdf2image <span class="keyword">import</span> convert_from_path,convert_from_bytes</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.arg(<span class="number">1</span>):</span><br><span class="line">            pdf_file = self.fm.thisfile.path</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pdf_file = self.rest(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        output = pdf_file[<span class="number">0</span>:<span class="number">-4</span>]</span><br><span class="line">        <span class="keyword">with</span> tempfile.TemporaryDirectory() <span class="keyword">as</span> path:</span><br><span class="line">            image_from_path = convert_from_path(pdf_file, dpi=<span class="number">400</span>, fmt=<span class="string">'png'</span>, output_folder=<span class="string">'.'</span>, output_file=output)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tab</span><span class="params">(self, tabnum)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self._tab_directory_content()</span><br></pre></td></tr></table></figure>

<p>我的其他脚本参见<a href="https://github.com/demonlord1997/script">这里</a></p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/05/19/coc-nvm-%E5%8D%87%E7%BA%A7%E5%90%8E%E6%8F%90%E7%A4%BAjedi%E7%89%88%E6%9C%AC%E5%A4%AA%E8%80%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">
                coc.nvm 升级后提示jedi版本太老解决方案
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-05-19</span>
            
            
            
                <span class="category">
                    <a href="/categories/配置/">配置</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <p>coc.nvim升级后，大概是coc-python版本在1.2.10以上时，在使用函数功能跳转时，会提示<code>jedi version %s too old, requires &gt;= 0.17.0</code>。这个问题在github上显示已解决，解决方案是安装指定版本的coc-python</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CocInstall coc-python@1.2.10</span><br></pre></td></tr></table></figure>
<p>但是这个方法并没有解决我的问题。这个版本的coc-python也是要求jedi版本大于0.17.0的。</p>
<p>因此我将jedi版本更新到了要求版本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip3 install jedi</span><br><span class="line"><span class="comment"># conda 如果只能安装0.16.0版本的话，可以先pip3安装，然后copy到conda的site-package文件夹下</span></span><br></pre></td></tr></table></figure>

<p>但是依然报错，信息如下：</p>
<blockquote>
<p>is_definition() got an unexpected keyword argument ‘include_setitem’, get_definition() got an unexpected keyword argument ‘include_setitem’</p>
</blockquote>
<p>你只需要到你的conda的jedi库文件夹中，找到<code>syntax_tree.py</code>，和<code>filter.py</code>这两个文件，修改相应的is_definition和get_definition即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">inference/syntax_tree.py</span><br><span class="line"><span class="number">667</span>:    node = tree_name.get_definition(import_name_always=<span class="literal">True</span>, include_setitem=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">inference/filters.py</span><br><span class="line"><span class="number">66</span>:            name <span class="keyword">for</span> name <span class="keyword">in</span> names <span class="keyword">if</span> name.is_definition(include_setitem=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>删除<code>include_setitem=True</code>即可。</p>
<hr>
<p>此外，推荐一个python函数跳转的插件<code>jedi-vim</code><br><code>vim-plug</code>安装方法：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Plug <span class="string">'davidhalter/jedi-vim'</span></span><br></pre></td></tr></table></figure>
<p>相关配置如下：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">g:jedi</span>#goto_command = <span class="string">"&lt;leader&gt;d"</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:jedi</span>#goto_assignments_command = <span class="string">"&lt;leader&gt;g"</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:jedi</span>#goto_stubs_command = <span class="string">"&lt;leader&gt;s"</span></span><br><span class="line"><span class="string">"let g:jedi#goto_definitions_command = "</span>gd<span class="comment">"</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:jedi</span>#documentation_command = <span class="string">"K"</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:jedi</span>#usages_command = <span class="string">"&lt;leader&gt;n"</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:jedi</span>#completions_command = <span class="string">"&lt;C-Space&gt;"</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">g:jedi</span>#rename_command = <span class="string">"&lt;leader&gt;r"</span></span><br></pre></td></tr></table></figure>
<p>这个跳转要比coc自带的要好一些，coc函数跳转默认你对文件进行了修改，当你使用<code>Ctrl-O</code>返回原文件时，需要保存一下跳转文件或者返回一次修改(按一下u)。但是<code>jedi-vim</code>不会对跳转文件进行修改。</p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/02/09/texdoc-package-name-%E6%8F%90%E7%A4%BA%E6%89%BE%E4%B8%8D%E5%88%B0%E6%96%87%E4%BB%B6/">
                texdoc [ package name ] 提示找不到文档
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-02-09</span>
            
            
            
                <span class="category">
                    <a href="/categories/LaTeX/">LaTeX</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <p>今天用texdoc查找文档，发现原来我的texdoc一直都不能用。<br>终端输入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">texdoc tikz</span><br></pre></td></tr></table></figure>
<p>结果提醒我<code>Sorry, no documentation found for tikz</code></p>
<p>没有tikz的文档吗？我不信，我自己找。</p>
<p><img src="https://s2.ax1x.com/2020/02/09/1f2PfJ.md.png" alt="tikz"></p>
<p>?texdoc你不是说没有吗？那我打开的是什么？</p>
<p>我觉得texdoc坏掉了，需要修理一下</p>
<p>于是我打开看了一下texmf.cnf</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/share/texmf/web2c/texmf.cnf</span><br></pre></td></tr></table></figure>
<p>发现了这么几行代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TEXMFCONFIG &#x3D; ~&#x2F;.texlive2017&#x2F;texmf-config</span><br><span class="line">TEXMFAUXTREES &#x3D; &#123;&#125;</span><br><span class="line">TEXMF &#x3D; &#123;$TEXMFAUXTREES$TEXMFCONFIG,$TEXMFVAR,$TEXMFHOME,!!$TEXMFLOCAL,$TEXMFSYSCONFIG,!!$TEXMFSYSVAR,!!$TEXMFDEBIAN,!!$TEXMFDIST&#125;</span><br></pre></td></tr></table></figure>
<p>它的寻找路径竟然是~/.texlive2017/texmf-config/，（实际上它不只这一条路径，但是没有一条路径是对的，而且我装得是texlive2019，看起来官方自17版以后就有些偷懒）</p>
<p>接下来你可以在终端执行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /usr/<span class="built_in">local</span>/texlive/2019/texmf-dist/doc ~/.texlive2017/texmf-config/doc -r</span><br></pre></td></tr></table></figure>
<p>如果没有<code>~/.texlive2017/texmf-config</code>这个文件夹，创建就好了（注意：我们cp的路径可能不一样，这取决于你包含说明文件的doc文件夹在哪里）</p>
<p>你也可以直接修改texmf.cnf文件，将 TEXMFCONFIG 的路径改为你doc所在路径，路径中应该是不包含doc这一级目录的。</p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/02/04/vim-choose-python2-or-python3-according-to-shebang/">
                vim根据shebang判断python2还是python3
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-02-04</span>
            
            
            
                <span class="category">
                    <a href="/categories/配置/">配置</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h2 id="shebang"><a href="#shebang" class="headerlink" title="shebang"></a>shebang</h2><p>shebang 通常写在脚本文件的第一行，用符号（#!）表示，#!后面跟着解释器的绝对路径。</p>
<p>当脚本被赋予可执行权限时，系统会选择shebang指定的解释器去执行脚本。</p>
<p>目前python已经分为了python2和python3两个版本，一些库还停留在python2版本，但是有时候我们还不得不用这些库，所以我们可能会在python2和python3之间切换，可我不想手动选择采用python2还是python3运行我的代码，那么如何在vim运行python文件时，选择shebang指定的解释器运行文件呢？</p>
<ul>
<li><p>我们可以在vim中使用global命令匹配shebang，比如在文件中看shebang有没有指定python2的解释器，那么我们只需要采用正则表达式寻找一个以#!开头、以python2结尾的字符串<br><code>[silent] exec g /^#!.*python2$/ %</code><br>silent 表示静默运行，即不输出运行信息，可加可不加</p>
</li>
<li><p>将匹配结果存入寄存器a中<br>我们只需要在正则表达式前后添加重定向语句redir即可</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">redir</span> @a</span><br><span class="line"></span><br><span class="line"><span class="symbol">&lt;command&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">redir</span> END</span><br></pre></td></tr></table></figure>
</li>
<li><p>判断寄存器a的值<br>global命令如果匹配到字符串，返回为空；如果匹配不到字符串，则返回Pattern not find。所以如果寄存器a为空则选择python2运行，否则python3运行。</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> @a == <span class="string">''</span></span><br><span class="line">    :term python2 %;echo '\n[python2]'</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    :term <span class="keyword">python3</span> %</span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure>


</li>
</ul>
<p>最后贴上整体代码</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">map</span> <span class="symbol">&lt;F5&gt;</span> :<span class="keyword">call</span> RunCode()<span class="symbol">&lt;CR&gt;</span></span><br><span class="line">func! RunCode()</span><br><span class="line">    exec <span class="string">"w"</span></span><br><span class="line">    <span class="keyword">if</span> &amp;<span class="keyword">filetype</span> == <span class="string">'python'</span></span><br><span class="line">        <span class="keyword">set</span> splitbelow</span><br><span class="line">        :<span class="keyword">sp</span></span><br><span class="line">        :<span class="keyword">res</span> -<span class="number">10</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">redir</span> @a</span><br><span class="line">        <span class="keyword">silent</span> exec <span class="string">"g /^#!.*python2$/ %"</span></span><br><span class="line">        <span class="keyword">redir</span> END</span><br><span class="line">        <span class="keyword">if</span> @a == <span class="string">''</span></span><br><span class="line">            :term python2 %;echo '\n[python2]'</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            :term <span class="keyword">python3</span> %</span><br><span class="line">        <span class="keyword">endif</span></span><br><span class="line">        <span class="keyword">normal</span> i</span><br><span class="line">    <span class="keyword">endif</span></span><br><span class="line">endfunc</span><br></pre></td></tr></table></figure>


        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/01/31/Configure-your-dwm/">
                Configure your dwm
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-01-31</span>
            
            
            
                <span class="category">
                    <a href="/categories/配置/">配置</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <p><a href="https://dwm.suckless.org/" target="_blank" rel="noopener">dwm</a>是<a href="https://suckless.org/" target="_blank" rel="noopener">suckless</a>开发的一款轻量级的桌面，你可以通过git下载，也可以进入dwm的官网<code>(https://dwm.suckless.org/)</code>下载</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://git.suckless.org/dwm</span><br></pre></td></tr></table></figure>
<h2 id="我的配置过程"><a href="#我的配置过程" class="headerlink" title="我的配置过程"></a>我的配置过程</h2><h3 id="编译流程"><a href="#编译流程" class="headerlink" title="编译流程"></a>编译流程</h3><ol>
<li><p>将config.def.h重命名为config.h</p>
<p> <code>mv config.def.h config.h</code></p>
</li>
</ol>
<ol start="2">
<li><p>编译</p>
<p> <code>sudo make clean install</code></p>
</li>
</ol>
<h3 id="配置开机启动项（我一般用lightdm管理）"><a href="#配置开机启动项（我一般用lightdm管理）" class="headerlink" title="配置开机启动项（我一般用lightdm管理）"></a>配置开机启动项（我一般用lightdm管理）</h3><blockquote>
<p>参考自Kerr</p>
</blockquote>
<p>创建/usr/share/xsessions/dwm.desktop 文件，写入以下内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[Desktop Entry]</span><br><span class="line">Encoding&#x3D;UTF-8</span><br><span class="line">Name&#x3D;dwm</span><br><span class="line">Comment&#x3D;Dynamic window manager</span><br><span class="line">Exec&#x3D;dwm</span><br><span class="line">Icon&#x3D;dwm</span><br><span class="line">Type&#x3D;XSession</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="dwm补丁文件"><a href="#dwm补丁文件" class="headerlink" title="dwm补丁文件"></a>dwm补丁文件</h2><ul>
<li><p><a href="https://dwm.suckless.org/patches/alpha/dwm-alpha-20180613-b69c870.diff" target="_blank" rel="noopener">dwm-alpha-20180613-b69c870.diff</a></p>
</li>
<li><p><a href="https://dwm.suckless.org/patches/autostart/dwm-autostart-20161205-bb3bd6f.diff" target="_blank" rel="noopener">dwm-autostart-20161205-bb3bd6f.diff</a></p>
</li>
<li><p><a href="https://dwm.suckless.org/patches/fullscreen/dwm-fullscreen-6.2.diff" target="_blank" rel="noopener">dwm-fullscreen-6.2.diff</a></p>
</li>
<li><p><a href="https://dwm.suckless.org/patches/hide_vacant_tags/dwm-hide_vacant_tags-6.2.diff" target="_blank" rel="noopener">dwm-hide_vacant_tags-6.2.diff</a></p>
</li>
<li><p><a href="https://dwm.suckless.org/patches/pertag/dwm-pertag-20170513-ceac8c9.diff" target="_blank" rel="noopener">dwm-pertag-20170513-ceac8c9.diff</a></p>
</li>
<li><p><a href="https://dwm.suckless.org/patches/viewontag/dwm-r1522-viewontag.diff" target="_blank" rel="noopener">dwm-r1522-viewontag.diff</a></p>
</li>
<li><p><a href="https://dwm.suckless.org/patches/rotatestack/dwm-rotatestack-20161021-ab9571b.diff" target="_blank" rel="noopener">dwm-rotatestack-20161021-ab9571b.diff</a></p>
</li>
<li><p><a href="https://dwm.suckless.org/patches/vanitygaps/dwm-vanitygaps-20190508-6.2.diff" target="_blank" rel="noopener">dwm-vanitygaps-20190508-6.2.diff</a></p>
</li>
</ul>
<table>
<thead>
<tr>
<th>patch</th>
<th>function</th>
</tr>
</thead>
<tbody><tr>
<td>alpha</td>
<td>为dwm添加窗口透明功能</td>
</tr>
<tr>
<td>autostart</td>
<td>配置进入dwm时的启动软件</td>
</tr>
<tr>
<td>fullscreen</td>
<td>为dwm添加全屏功能</td>
</tr>
<tr>
<td>hide_vacant_tags</td>
<td>隐藏空tags（没有软件运行的tags）</td>
</tr>
<tr>
<td>pertag</td>
<td>不同tag拥有不同的窗口布局</td>
</tr>
<tr>
<td>viewontag</td>
<td>移动窗口至新tag时，视窗随之转换至新tag</td>
</tr>
<tr>
<td>rotatestack</td>
<td>在打开的窗口之间循环</td>
</tr>
<tr>
<td>vanitygaps</td>
<td>添加窗口之间的间隙</td>
</tr>
</tbody></table>
<p>但是rotatestack的工作方式并不是我想要的，它总是在移动窗口的同时把光标也随着一起移动过去，我希望我选中的窗口能够循环地出现在我的master区，即我屏幕的左半部分，这样我编辑起来更加方便，所以我需要对这个补丁进行更改，禁止它的光标移动。</p>
<p>其实做法也很简单，你只需要在你打完补丁的dwm.c文件中，注释掉下面几行即可</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!selmon-&gt;sel)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">f = selmon-&gt;sel;</span><br></pre></td></tr></table></figure>
<p>或者你只注释掉f = selmon-&gt;sel;也可以</p>
<p>效果如下（gif动图看起来有些卡）</p>
<p><img src="https://s2.ax1x.com/2020/01/31/18GgvF.gif" alt="dwm"></p>
<h3 id="我的键位配置"><a href="#我的键位配置" class="headerlink" title="我的键位配置"></a>我的键位配置</h3><p>我的dwm配置已经传到我的<a href="https://github.com/demonlord1997/dwm">github</a></p>
<table>
<thead>
<tr>
<th>keybinds</th>
<th>function</th>
</tr>
</thead>
<tbody><tr>
<td>win+o</td>
<td>循环移动窗口</td>
</tr>
<tr>
<td>win+shift+o</td>
<td>循环移动光标</td>
</tr>
<tr>
<td>win+z</td>
<td>当前窗口置为主窗口</td>
</tr>
<tr>
<td>win+shift+number</td>
<td>移动当前窗口到指定tag</td>
</tr>
<tr>
<td>win+number</td>
<td>移动到指定tag</td>
</tr>
<tr>
<td>win+t</td>
<td>窗口设为平铺模式</td>
</tr>
<tr>
<td>win+s</td>
<td>窗口设为浮动模式</td>
</tr>
<tr>
<td>win+m</td>
<td>窗口设为层叠模式</td>
</tr>
<tr>
<td>win+shift+t</td>
<td>打开/关闭图标面板（trayer）</td>
</tr>
<tr>
<td>win+shift+q</td>
<td>关闭打开的软件</td>
</tr>
<tr>
<td>win+shift+e</td>
<td>退出dwm</td>
</tr>
<tr>
<td>Fn+F3(增加音量键)</td>
<td>增加音量</td>
</tr>
<tr>
<td>Fn+F2</td>
<td>减音量</td>
</tr>
<tr>
<td>Fn+F1</td>
<td>静音</td>
</tr>
</tbody></table>
<p>如果你想使用Fn+其他的键，你需要导入系统的XF86keysym.h头文件，我是在dwm.c中添加了：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;X11/XF86keysym.h&gt;</span></span></span><br></pre></td></tr></table></figure>
<h2 id="dwm-scripts"><a href="#dwm-scripts" class="headerlink" title="dwm scripts"></a>dwm scripts</h2><p>我的一些脚本<a href="https://github.com/demonlord1997/script">script</a></p>
<p>script中需要安装的软件</p>
<ul>
<li>acpi</li>
<li>acpitool</li>
<li>trayer</li>
<li>compton</li>
</ul>
<p>我的dwm最终效果如下：<br><img src="https://s2.ax1x.com/2020/02/01/18XGmq.md.png" alt="dwm"></p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/01/25/Install-fzf(%E6%A8%A1%E7%B3%8A%E6%96%87%E4%BB%B6%E6%9F%A5%E6%89%BE)/">
                Install fzf（模糊文件查找）
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-01-25</span>
            
            
            
                <span class="category">
                    <a href="/categories/配置/">配置</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h2 id="shell下的fzf"><a href="#shell下的fzf" class="headerlink" title="shell下的fzf"></a>shell下的fzf</h2><h3 id="安装ccat"><a href="#安装ccat" class="headerlink" title="安装ccat"></a>安装ccat</h3><p>ccat和cat的功能一样，但是ccat能够高亮显示，但是cat不能，ccat安装方法如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/jingweno/ccat/releases/download/v1.1.0/linux-amd64-1.1.0.tar.gz</span><br><span class="line">tar -xvf  linux-amd64-1.1.0.tar.gz</span><br><span class="line">sudo cp ./linux-amd64-1.1.0/ccat  /usr/bin/</span><br></pre></td></tr></table></figure>
<h3 id="安装fzf"><a href="#安装fzf" class="headerlink" title="安装fzf"></a>安装fzf</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --depth 1 https://github.com/junegunn/fzf.git ~/.fzf</span><br><span class="line">~/.fzf/install</span><br></pre></td></tr></table></figure>
<p>当然你需要确保你安装了git</p>
<h3 id="配置zshrc"><a href="#配置zshrc" class="headerlink" title="配置zshrc"></a>配置zshrc</h3><p>在你的zshrc中写入：</p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> FZF_DEFAULT_OPTS=<span class="string">'--bind ctrl-j:down,ctrl-k:up --preview "[[ $(file --mime &#123;&#125;) =~ binary ]] &amp;&amp; echo &#123;&#125; is a binary file || (ccat --color=always &#123;&#125; || highlight -O ansi -l &#123;&#125; || cat &#123;&#125;) 2&gt; /dev/null | head -500"'</span></span><br><span class="line"><span class="built_in">export</span> FZF_DEFAULT_COMMAND=<span class="string">'fd --type f --hidden --follow --exclude .git . ~/.config /home / '</span></span><br><span class="line"><span class="built_in">export</span> FZF_COMPLETION_TRIGGER=<span class="string">'\'</span></span><br><span class="line"><span class="built_in">export</span> FZF_PREVIEW_COMMAND=<span class="string">'[[ $(file --mime &#123;&#125;) =~ binary ]] &amp;&amp; echo &#123;&#125; is a binary file || (ccat --color=always &#123;&#125; || highlight -O ansi -l &#123;&#125; || cat &#123;&#125;) 2&gt; /dev/null | head -500'</span></span><br></pre></td></tr></table></figure>
<p>如果你用的是bash或其他shell，应该也是可以的，你只要在相应的rc中写入这段命令就可以了</p>
<p>终端输入fzf就可以开始查找文件了，fzf会返回你的文件路径</p>
<p><img src="https://s2.ax1x.com/2020/01/25/1eW2tA.md.png" alt="shell_fzf"></p>
<p>而且fzf可以和其他命令很好的交互，比方说我用vim和fzf交互，只需要输入<code>vim \</code>然后按下&lt;Tab&gt;键，就可以查找我需要编辑的文件，找到后按下回车就可以开始编辑文件</p>
<p><img src="https://s2.ax1x.com/2020/01/26/1mDBuj.md.png" alt="shell_interfzf"></p>
<p>ps: 我额外安装了<a href="https://github.com/sharkdp/fd">fd</a>作为搜索工具</p>
<h2 id="neovim下的fzf"><a href="#neovim下的fzf" class="headerlink" title="neovim下的fzf"></a>neovim下的fzf</h2><h3 id="安装fzf-vim"><a href="#安装fzf-vim" class="headerlink" title="安装fzf.vim"></a>安装fzf.vim</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Plug <span class="string">'junegunn/fzf'</span>, &#123; <span class="string">'dir'</span>: <span class="string">'~/.fzf'</span>, <span class="string">'do'</span>: <span class="string">'./install --all'</span> &#125;</span><br><span class="line">Plug <span class="string">'junegunn/fzf.vim'</span></span><br></pre></td></tr></table></figure>
<h3 id="配置fzf"><a href="#配置fzf" class="headerlink" title="配置fzf"></a>配置fzf</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">" find file</span></span><br><span class="line"><span class="keyword">noremap</span> \ :FZF<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="comment">" find history</span></span><br><span class="line"><span class="keyword">noremap</span> <span class="symbol">&lt;C-h&gt;</span> :MRU<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="comment">" find lines containing keywords</span></span><br><span class="line"><span class="keyword">noremap</span> <span class="symbol">&lt;C-l&gt;</span> :LinesWithPreview<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"><span class="comment">" find buffer</span></span><br><span class="line"><span class="keyword">noremap</span> <span class="symbol">&lt;C-b&gt;</span> :Buffers<span class="symbol">&lt;CR&gt;</span></span><br><span class="line"></span><br><span class="line">autocmd! FileType fzf</span><br><span class="line"><span class="keyword">autocmd</span>  FileType fzf <span class="keyword">set</span> laststatus=<span class="number">0</span> noruler</span><br><span class="line">  \| <span class="keyword">autocmd</span> BufLeave <span class="symbol">&lt;buffer&gt;</span> <span class="keyword">set</span> laststatus=<span class="number">2</span> ruler</span><br><span class="line"></span><br><span class="line">command! -bang -nargs=* Buffers</span><br><span class="line">  \ <span class="keyword">call</span> fzf#vim#buffers(</span><br><span class="line">  \   <span class="string">''</span>,</span><br><span class="line">  \   <span class="symbol">&lt;bang&gt;</span><span class="number">0</span> ? fzf#vim#with_preview(<span class="string">'up:60%'</span>)</span><br><span class="line">  \           : fzf#vim#with_preview(<span class="string">'right:0%'</span>, <span class="string">'?'</span>),</span><br><span class="line">  \   <span class="symbol">&lt;bang&gt;</span><span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">command! -bang -nargs=* LinesWithPreview</span><br><span class="line">    \ <span class="keyword">call</span> fzf#vim#grep(</span><br><span class="line">    \   <span class="string">'rg --with-filename --column --line-number --no-heading --color=always --smart-case . '</span>.<span class="built_in">fnameescape</span>(<span class="built_in">expand</span>(<span class="string">'%'</span>)), <span class="number">1</span>,</span><br><span class="line">    \   fzf#vim#with_preview(&#123;<span class="string">'options'</span>: <span class="string">'--delimiter : --nth 4.. --sort'</span>&#125;, <span class="string">'up:50%'</span>, <span class="string">'?'</span>),</span><br><span class="line">    \   <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">command! -bang -nargs=* MRU <span class="keyword">call</span> fzf#vim#history(fzf#vim#with_preview())</span><br></pre></td></tr></table></figure>
<p>当我在vim中按下”\“，vim会调用fzf查找你需要编辑的文件，选中文件后回车即可编辑<br><img src="https://s2.ax1x.com/2020/01/26/1mrpVI.md.png" alt="VIM#FZF"></p>
<p>当我在vim中按下”Ctrl+h”，vim会显示你最近打开的文件<br><img src="https://s2.ax1x.com/2020/01/26/1mrVMQ.md.png" alt="VIM#FZF#history"></p>
<p>当我在vim中按下”Ctrl+l”，vim会高亮包含你搜索关键词的一行代码<br><img src="https://s2.ax1x.com/2020/01/26/1mrnZn.md.png" alt="VIM#FZF#lines"></p>
<p>当我在vim中按下”Ctrl+b”，vim会显示当前你打开的buffer，输入数字或者符号即可跳转buffer<br><img src="https://s2.ax1x.com/2020/01/26/1mriPf.png" alt="VIM#FZF#buffer"></p>
<h2 id="ranger下的fzf"><a href="#ranger下的fzf" class="headerlink" title="ranger下的fzf"></a>ranger下的fzf</h2><h3 id="修改ranger的commands-py"><a href="#修改ranger的commands-py" class="headerlink" title="修改ranger的commands.py"></a>修改ranger的commands.py</h3><p>在<code>commands.py</code>中定义<code>fzf_select</code>类</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">fzf_select</span><span class="params">(Command)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    :fzf_select</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Find a file using fzf.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    With a prefix argument select only directories.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    See: https://github.com/junegunn/fzf</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">execute</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">import</span> subprocess</span><br><span class="line">        <span class="keyword">import</span> os.path</span><br><span class="line">        <span class="keyword">if</span> self.quantifier:</span><br><span class="line">            <span class="comment"># match only directories</span></span><br><span class="line">            command=<span class="string">"find -L . \( -path '*/\.*' -o -fstype 'dev' -o -fstype 'proc' \) -prune \</span></span><br><span class="line"><span class="string">            -o -type d -print 2&gt; /dev/null | sed 1d | cut -b3- | fzf +m"</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># match files and directories</span></span><br><span class="line">            command=<span class="string">"find -L . \( -path '*/\.*' -o -fstype 'dev' -o -fstype 'proc' \) -prune \</span></span><br><span class="line"><span class="string">            -o -print 2&gt; /dev/null | sed 1d | cut -b3- | fzf +m"</span></span><br><span class="line">        fzf = self.fm.execute_command(command, universal_newlines=<span class="literal">True</span>, stdout=subprocess.PIPE)</span><br><span class="line">        stdout, stderr = fzf.communicate()</span><br><span class="line">        <span class="keyword">if</span> fzf.returncode == <span class="number">0</span>:</span><br><span class="line">            fzf_file = os.path.abspath(stdout.rstrip(<span class="string">'\n'</span>))</span><br><span class="line">            <span class="keyword">if</span> os.path.isdir(fzf_file):</span><br><span class="line">                self.fm.cd(fzf_file)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.fm.select_file(fzf_file)</span><br></pre></td></tr></table></figure>

<h3 id="配置你的rc-conf"><a href="#配置你的rc-conf" class="headerlink" title="配置你的rc.conf"></a>配置你的rc.conf</h3><p>在你的rc.conf中写入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">map \ fzf_select</span><br></pre></td></tr></table></figure>
<p><img src="https://s2.ax1x.com/2020/01/26/1mrTyQ.md.png" alt="Ranger#FZF"></p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/01/24/%E8%AE%BE%E8%AE%A1%E4%BD%A0%E7%9A%84%E4%BB%A3%E7%A0%81%E9%AB%98%E4%BA%AE/">
                设计你的代码高亮
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-01-24</span>
            
            
            
                <span class="category">
                    <a href="/categories/配置/">配置</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <p>之前一直在用一款叫做molokai的主题，尽管molokai很流行，也很漂亮，但是它在neovim上的样式我并不是十分喜欢。比方说它的行号背景，我觉得很突兀，我不喜欢；数字的颜色，我觉得molokai整体的色彩搭配都偏暗，我希望它的数字颜色亮一些；当前行的背景色太明显，我希望它的颜色淡一些；而且我很不习惯它对括号显示的方式。因此我需要对其主题进行一定的修改。</p>
<p><img src="https://s2.ax1x.com/2020/01/24/1Z4w8I.md.png" alt="molokai"></p>
<hr>
<p>我的修改：</p>
<ul>
<li>去掉行号的背景色</li>
<li>修改括号的显示色彩</li>
<li>修改数字的前景色（蓝-&gt;黄）</li>
<li>自定义状态栏显示样式与色彩</li>
<li>修改错误提示颜色</li>
<li>修改高亮行的背景色和前景色</li>
</ul>
<p>修改后的显示效果：</p>
<p><img src="https://s2.ax1x.com/2020/01/24/1Zo94H.md.png" alt="vegeta"></p>
<p>同molokai主题一样，这个主题也需要开启256色支持，即你需要在你的vim/neovim的配置文件中写入：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> t_Co=<span class="number">256</span></span><br></pre></td></tr></table></figure>

<p>在这里我对部分代码规则进行简单的解释</p>
<table>
<thead>
<tr>
<th align="left">type</th>
<th align="left">explain</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Boolean</td>
<td align="left">对布尔型数据设置高亮色</td>
</tr>
<tr>
<td align="left">Character</td>
<td align="left">对字符型数据设置高亮色</td>
</tr>
<tr>
<td align="left">Number</td>
<td align="left">对数字设置高亮色</td>
</tr>
<tr>
<td align="left">Float</td>
<td align="left">对浮点型数据设置高亮色</td>
</tr>
<tr>
<td align="left">String</td>
<td align="left">对字符串设置高亮色</td>
</tr>
<tr>
<td align="left">Constant</td>
<td align="left">对常量设置高亮色</td>
</tr>
<tr>
<td align="left">Function</td>
<td align="left">对函数名设置高亮色</td>
</tr>
<tr>
<td align="left">keyword</td>
<td align="left">对关键词设置高亮色</td>
</tr>
<tr>
<td align="left">Visual</td>
<td align="left">对选中行（高亮行）设置高亮色</td>
</tr>
<tr>
<td align="left">CursorLine</td>
<td align="left">对光标行设置高亮色</td>
</tr>
<tr>
<td align="left">MatchParen</td>
<td align="left">对括号设置高亮色</td>
</tr>
<tr>
<td align="left">LineNr</td>
<td align="left">对行号设置高亮色</td>
</tr>
</tbody></table>
<p>最后附上主题代码：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">" Remove all existing highlighting and set the defaults.</span></span><br><span class="line"><span class="keyword">hi</span> clear</span><br><span class="line"></span><br><span class="line"><span class="comment">" Load the syntax highlighting defaults, if it's enabled.</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">exists</span>(<span class="string">"syntax_on"</span>)</span><br><span class="line">  <span class="keyword">syntax</span> reset</span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"><span class="keyword">let</span> colors_name = <span class="string">"vegeta"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> &amp;t_Co &gt; <span class="number">255</span></span><br><span class="line">   <span class="keyword">hi</span> Normal                       ctermbg=<span class="number">234</span></span><br><span class="line">   <span class="keyword">hi</span> CursorLine                   ctermbg=<span class="number">233</span>   cterm=none</span><br><span class="line">   <span class="keyword">hi</span> CursorLineNr    ctermfg=<span class="number">208</span>                cterm=none</span><br><span class="line">   <span class="keyword">hi</span> Boolean         ctermfg=<span class="number">135</span></span><br><span class="line">   <span class="keyword">hi</span> Character       ctermfg=<span class="number">144</span></span><br><span class="line">   <span class="keyword">hi</span> Number          ctermfg=<span class="number">190</span></span><br><span class="line">   <span class="keyword">hi</span> String          ctermfg=<span class="number">144</span></span><br><span class="line">   <span class="keyword">hi</span> Conditional     ctermfg=<span class="number">161</span>                cterm=bold</span><br><span class="line">   <span class="keyword">hi</span> Constant        ctermfg=<span class="number">135</span>                cterm=bold</span><br><span class="line">   <span class="keyword">hi</span> Cursor          ctermfg=<span class="number">16</span>   ctermbg=<span class="number">253</span></span><br><span class="line">   <span class="keyword">hi</span> Debug           ctermfg=<span class="number">225</span>                cterm=bold</span><br><span class="line">   <span class="keyword">hi</span> Define          ctermfg=<span class="number">81</span></span><br><span class="line">   <span class="keyword">hi</span> Delimiter       ctermfg=<span class="number">241</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">hi</span> DiffAdd                      ctermbg=<span class="number">24</span></span><br><span class="line">   <span class="keyword">hi</span> DiffChange      ctermfg=<span class="number">181</span>  ctermbg=<span class="number">239</span></span><br><span class="line">   <span class="keyword">hi</span> DiffDelete      ctermfg=<span class="number">162</span>  ctermbg=<span class="number">53</span></span><br><span class="line">   <span class="keyword">hi</span> DiffText                     ctermbg=<span class="number">102</span>   cterm=bold</span><br><span class="line"></span><br><span class="line">   <span class="keyword">hi</span> Directory       ctermfg=<span class="number">118</span>                cterm=bold</span><br><span class="line">   <span class="keyword">hi</span> Error           ctermfg=<span class="number">219</span>  ctermbg=<span class="number">124</span></span><br><span class="line">   <span class="keyword">hi</span> ErrorMsg        ctermfg=<span class="number">199</span>  ctermbg=<span class="number">16</span>    cterm=bold</span><br><span class="line">   <span class="keyword">hi</span> Exception       ctermfg=<span class="number">118</span>                cterm=bold</span><br><span class="line">   <span class="keyword">hi</span> Float           ctermfg=<span class="number">135</span></span><br><span class="line">   <span class="keyword">hi</span> FoldColumn      ctermfg=<span class="number">67</span>   ctermbg=<span class="number">16</span></span><br><span class="line">   <span class="keyword">hi</span> Folded          ctermfg=<span class="number">67</span>   ctermbg=<span class="number">16</span></span><br><span class="line">   <span class="keyword">hi</span> Function        ctermfg=<span class="number">118</span></span><br><span class="line">   <span class="keyword">hi</span> Identifier      ctermfg=<span class="number">208</span>                cterm=none</span><br><span class="line">   <span class="keyword">hi</span> Ignore          ctermfg=<span class="number">244</span>  ctermbg=<span class="number">232</span></span><br><span class="line">   <span class="keyword">hi</span> IncSearch       ctermfg=<span class="number">193</span>  ctermbg=<span class="number">16</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">hi</span> keyword         ctermfg=<span class="number">161</span>                cterm=bold</span><br><span class="line">   <span class="keyword">hi</span> Label           ctermfg=<span class="number">229</span>                cterm=none</span><br><span class="line">   <span class="keyword">hi</span> Macro           ctermfg=<span class="number">193</span></span><br><span class="line">   <span class="keyword">hi</span> SpecialKey      ctermfg=<span class="number">81</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">hi</span> MatchParen      ctermfg=<span class="number">208</span>  ctermbg=<span class="number">233</span>   cterm=bold</span><br><span class="line">   <span class="keyword">hi</span> ModeMsg         ctermfg=<span class="number">229</span></span><br><span class="line">   <span class="keyword">hi</span> MoreMsg         ctermfg=<span class="number">229</span></span><br><span class="line">   <span class="keyword">hi</span> Operator        ctermfg=<span class="number">161</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">" complete menu</span></span><br><span class="line">   <span class="keyword">hi</span> Pmenu           ctermfg=<span class="number">220</span>  ctermbg=<span class="number">233</span></span><br><span class="line">   <span class="keyword">hi</span> PmenuSel        ctermfg=<span class="number">255</span>  ctermbg=<span class="number">242</span></span><br><span class="line">   <span class="keyword">hi</span> PmenuSbar                    ctermbg=<span class="number">232</span></span><br><span class="line">   <span class="keyword">hi</span> PmenuThumb      ctermfg=<span class="number">220</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">hi</span> PreCondit       ctermfg=<span class="number">118</span>                cterm=bold</span><br><span class="line">   <span class="keyword">hi</span> PreProc         ctermfg=<span class="number">118</span></span><br><span class="line">   <span class="keyword">hi</span> Question        ctermfg=<span class="number">220</span></span><br><span class="line">   <span class="keyword">hi</span> Repeat          ctermfg=<span class="number">161</span>                cterm=bold</span><br><span class="line">   <span class="keyword">hi</span> Search          ctermfg=<span class="number">0</span>    ctermbg=<span class="number">222</span>   cterm=NONE</span><br><span class="line"></span><br><span class="line">   <span class="comment">" marks column</span></span><br><span class="line">   <span class="keyword">hi</span> SignColumn      ctermfg=<span class="number">118</span>  ctermbg=<span class="number">235</span></span><br><span class="line">   <span class="keyword">hi</span> SpecialChar     ctermfg=<span class="number">161</span>                cterm=bold</span><br><span class="line">   <span class="keyword">hi</span> SpecialComment  ctermfg=<span class="number">245</span>                cterm=bold</span><br><span class="line">   <span class="keyword">hi</span> Special         ctermfg=<span class="number">81</span></span><br><span class="line">   <span class="keyword">if</span> <span class="built_in">has</span>(<span class="string">"spell"</span>)</span><br><span class="line">       <span class="keyword">hi</span> SpellBad                 ctermbg=<span class="number">52</span></span><br><span class="line">       <span class="keyword">hi</span> SpellCap                 ctermbg=<span class="number">17</span></span><br><span class="line">       <span class="keyword">hi</span> SpellLocal               ctermbg=<span class="number">17</span></span><br><span class="line">       <span class="keyword">hi</span> SpellRare   ctermfg=none ctermbg=none  cterm=<span class="built_in">reverse</span></span><br><span class="line">   <span class="keyword">endif</span></span><br><span class="line">   <span class="keyword">hi</span> Statement       ctermfg=<span class="number">161</span>                cterm=bold</span><br><span class="line">   <span class="keyword">hi</span> StorageClass    ctermfg=<span class="number">208</span></span><br><span class="line">   <span class="keyword">hi</span> Structure       ctermfg=<span class="number">81</span></span><br><span class="line">   <span class="keyword">hi</span> Tag             ctermfg=<span class="number">161</span></span><br><span class="line">   <span class="keyword">hi</span> Title           ctermfg=<span class="number">166</span></span><br><span class="line">   <span class="keyword">hi</span> Todo            ctermfg=<span class="number">231</span>  ctermbg=<span class="number">232</span>   cterm=bold</span><br><span class="line"></span><br><span class="line">   <span class="keyword">hi</span> Typedef         ctermfg=<span class="number">81</span></span><br><span class="line">   <span class="keyword">hi</span> Type            ctermfg=<span class="number">81</span>                 cterm=none</span><br><span class="line">   <span class="keyword">hi</span> Underlined      ctermfg=<span class="number">244</span>                cterm=underline</span><br><span class="line"></span><br><span class="line">   <span class="keyword">hi</span> VertSplit       ctermfg=<span class="number">244</span>  ctermbg=<span class="number">232</span>   cterm=bold</span><br><span class="line">   <span class="keyword">hi</span> VisualNOS                    ctermbg=<span class="number">238</span></span><br><span class="line">   <span class="keyword">hi</span> Visual          ctermfg=<span class="number">220</span>  ctermbg=<span class="number">241</span></span><br><span class="line">   <span class="keyword">hi</span> WarningMsg      ctermfg=<span class="number">231</span>  ctermbg=<span class="number">238</span>   cterm=bold</span><br><span class="line">   <span class="keyword">hi</span> WildMenu        ctermfg=<span class="number">81</span>   ctermbg=<span class="number">16</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">hi</span> Comment         ctermfg=<span class="number">59</span></span><br><span class="line">   <span class="keyword">hi</span> CursorColumn                 ctermbg=<span class="number">233</span></span><br><span class="line">   <span class="keyword">hi</span> ColorColumn                  ctermbg=<span class="number">236</span></span><br><span class="line">   <span class="keyword">hi</span> LineNr          ctermfg=<span class="number">250</span>  ctermbg=<span class="number">0</span></span><br><span class="line">   <span class="keyword">hi</span> NonText         ctermfg=<span class="number">59</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">hi</span> SpecialKey      ctermfg=<span class="number">59</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">set</span> statusline=%<span class="number">1</span>*\%&lt;%.<span class="number">50</span>F\                                     <span class="comment">"显示文件名和文件路径</span></span><br><span class="line">   <span class="keyword">set</span> statusline+=%=%<span class="number">2</span>*\%<span class="keyword">y</span>%<span class="keyword">m</span>%r%h%<span class="keyword">w</span>\ %*                            <span class="comment">"显示文件类型及文件状态</span></span><br><span class="line">   <span class="keyword">set</span> statusline+=%<span class="number">3</span>*\%&#123;&amp;ff&#125;\[%&#123;&amp;fenc&#125;]\ %*                       <span class="comment">"显示文件编码类型</span></span><br><span class="line">   <span class="keyword">set</span> statusline+=%<span class="number">5</span>*\%<span class="number">3</span><span class="keyword">p</span>%%\%*                                    <span class="comment">"显示光标前文本所占总文本的比例</span></span><br><span class="line">   <span class="keyword">hi</span> User1 cterm=none ctermfg=<span class="number">12</span>  ctermbg=<span class="number">0</span></span><br><span class="line">   <span class="keyword">hi</span> User2 cterm=none ctermfg=<span class="number">208</span> ctermbg=<span class="number">0</span></span><br><span class="line">   <span class="keyword">hi</span> User3 cterm=none ctermfg=<span class="number">169</span> ctermbg=<span class="number">0</span></span><br><span class="line">   <span class="keyword">hi</span> User5 cterm=none ctermfg=green ctermbg=<span class="number">0</span></span><br><span class="line"><span class="keyword">endif</span></span><br></pre></td></tr></table></figure>
<p>关于vim状态栏的设计，可以参考我的另外一篇<a href="https://blog.csdn.net/l_changyun/article/details/98252459" target="_blank" rel="noopener">博客</a></p>

        </div>
    

</div>
            
                
<div class="post">

    <div class="post-header index">
        <h1 class="title">
            <a href="/2020/01/22/%E6%9B%B4%E6%8D%A2%E5%A3%81%E7%BA%B8%E7%9A%84%E8%84%9A%E6%9C%AC/">
                Linux系统更换壁纸的脚本
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-01-22</span>
            
            
            
                <span class="category">
                    <a href="/categories/配置/">配置</a>
                </span>
            
        </div>
    </div>

    
        <div class="content">
            <h2 id="安装feh"><a href="#安装feh" class="headerlink" title="安装feh"></a>安装feh</h2><p>feh 是用来打开图片和设置壁纸的一款软件，本脚本中通过feh实现壁纸更换功能</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install feh</span><br></pre></td></tr></table></figure>
<p>我壁纸目录下的文件如下：</p>
<p><img src="https://s2.ax1x.com/2020/01/22/1AhYan.md.png" alt="wallpapers"></p>
<ul>
<li><code>wallpapers.sh</code>是我的脚本文件</li>
</ul>
<hr>
<p><code>name=`ls ~/Pictures/wallpapers/ |grep -v .sh`</code>获取除<code>.sh</code> 文件的所有文件名字</p>
<p><code>nameArray=(${name})</code>将文件名字存入nameArray数组中</p>
<p><code>N=${ #nameArray[*] }</code>获取数组中的元素数量</p>
<p><code>var=${nameArray[$[RANDOM%$N]]}</code>生成随机数，并取出其在数组中对应的壁纸</p>
<p><code>feh --bg-scale ~/Pictures/wallpapers/$var</code>设置壁纸</p>
<p>整体代码如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">name=`ls ~/Pictures/wallpapers/ |grep -v .sh`</span><br><span class="line">nameArray=(<span class="variable">$&#123;name&#125;</span>)</span><br><span class="line">N=<span class="variable">$&#123;#nameArray[*]&#125;</span></span><br><span class="line">var=<span class="variable">$&#123;nameArray[$[RANDOM%$N]]&#125;</span></span><br><span class="line">feh --<span class="built_in">bg</span>-scale ~/Pictures/wallpapers/<span class="variable">$var</span></span><br></pre></td></tr></table></figure>

        </div>
    

</div>
            
        </section>
    </div>
</div>



    <div class="row">
        <div class="col-sm-12">
            <div class="wrap-pagination">
                <a class="disabled" href="/">
                    <i class="fa fa-chevron-left" aria-hidden="true"></i>
                </a>
                <a class="" href="/page/2/">
                    <i class="fa fa-chevron-right" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </div>




</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                    This theme was developed by <a href="https://github.com/klugjo">Jonathan Klughertz</a>. The source code is available on Github. Create Websites. Make Magic.
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2020/07/03/PlotNeuralNet%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/">PlotNeuralNet个性化定制与使用说明</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2020/06/26/extract-images-from-pdf/">extract images from pdf</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2020/06/15/LaTeX-output-to-image/">LaTeX output to image</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2020/05/19/coc-nvm-%E5%8D%87%E7%BA%A7%E5%90%8E%E6%8F%90%E7%A4%BAjedi%E7%89%88%E6%9C%AC%E5%A4%AA%E8%80%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">coc.nvm 升级后提示jedi版本太老解决方案</a>
            </li>
            
        </ul>
    </div>



            
<div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 footer-categories">
    <h2>Categories</h2>
    <ul>
        
        <li>
            <a class="footer-post" href="/categories/PlotNeuralNet/">PlotNeuralNet</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/LaTeX/">LaTeX</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/%E9%85%8D%E7%BD%AE/">配置</a>
        </li>
        
    </ul>
</div>

        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a href="https://github.com/demonlord1997">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    <li class="list-inline-item">
                        <a href="\#">
                            <span class="footer-icon-container">
                                <i class="fa fa-rss"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    @Untitled. All right reserved | Design & Hexo <a href="http://www.codeblocq.com/" target="_blank" rel="noopener">Jonathan Klughertz</a>
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->

<script src="/js/main.js"></script>


<!-- Disqus Comments -->



</body>

</html>